# 学习器 (Learner)

[burn-train](https://github.com/tracel-ai/burn/tree/main/crates/burn-train) crate 封装了多个用于训练深度学习模型的实用工具。该 crate 的目标是为用户提供精心设计且灵活的训练循环，因此项目不必从头开始编写这些组件。大多数与 `burn-train` 的交互将通过 `LearnerBuilder` 结构体进行，在之前的[训练部分](../basic-workflow/training.html)中简要介绍过。这个结构体使您能够配置训练循环，支持注册指标、启用日志记录、检查点状态、使用多个设备等等。

当前提供的 API 中仍有一些假设，这可能使它们不适合您的学习需求。实际上，它们假设您的模型将从训练数据集学习，并针对另一个数据集进行验证。这是最常见的范式，允许用户进行监督和无监督学习以及微调。但是，对于更复杂的需求，创建[自定义训练循环](../custom-training-loop.html)可能是您所需要的。

## 用法 (Usage)

学习器构建器在配置方面提供了众多选项。

| 配置 | 描述 |
|------|------|
| 训练指标 | 注册训练指标 |
| 验证指标 | 注册验证指标 |
| 训练指标绘图 | 注册带绘图的训练指标（要求指标为数值）|
| 验证指标绘图 | 注册带绘图的验证指标（要求指标为数值）|
| 指标记录器 | 配置指标记录器（默认保存到文件）|
| 渲染器 | 配置如何渲染指标（默认为 CLI）|
| 梯度累积 | 配置应用梯度之前的步数 |
| 文件检查点 | 配置模型、优化器和调度器状态的保存方式 |
| 训练轮数 | 设置训练轮数 |
| 设备 | 设置要使用的设备 |
| 检查点 | 从检查点重新开始训练 |
| 应用程序日志 | 配置应用程序日志记录器（默认写入 `experiment.log`）|

当构建器配置到您满意的程度时，您就可以继续构建学习器。build 方法需要三个输入：模型、优化器和学习率调度器。请注意，后者可以是一个简单的浮点数，如果您希望它在训练期间保持恒定。

结果将是一个新创建的 Learner 结构体，它只有一个方法 `fit` 函数，必须使用训练和验证数据加载器调用。这将开始训练并在完成后返回训练好的模型。

再次，请参考[训练部分](../basic-workflow/training.html)获取相关的代码片段。

## 产物 (Artifacts)

当创建新构建器时，所有收集的数据将保存在作为 `new` 方法参数提供的目录下。以下是使用压缩消息包格式记录的模型的数据布局示例，其中注册了准确率和损失指标：

```
├── experiment.log
├── checkpoint
│   ├── model-1.mpk.gz
│   ├── optim-1.mpk.gz
│   └── scheduler-1.mpk.gz
│   ├── model-2.mpk.gz
│   ├── optim-2.mpk.gz
│   └── scheduler-2.mpk.gz
├── train
│   ├── epoch-1
│   │   ├── Accuracy.log
│   │   └── Loss.log
│   └── epoch-2
│       ├── Accuracy.log
│       └── Loss.log
└── valid
    ├── epoch-1
    │   ├── Accuracy.log
    │   └── Loss.log
    └── epoch-2
        ├── Accuracy.log
        └── Loss.log
```

如果需要，您可以选择保存该本地目录或与远程文件系统同步。文件检查点器能够根据指定配置自动删除旧检查点。

---

*本文档翻译自 Burn 官方文档：https://burn.dev/books/burn/building-blocks/learner.html*
